{% load static %}

<!-- Dark Modern Sidebar -->
<div id="admin-sidebar" class="bg-slate-800 text-white flex flex-col z-30" style="width: 256px; min-height: 100vh; position: sticky; top: 0;">
    <!-- Logo/Brand -->
    <div class="p-4 flex items-center justify-between">
        <div class="flex items-center space-x-2">
            <div class="w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center">
                <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M5.5 16a3.5 3.5 0 01-.369-6.98 4 4 0 117.753-1.977A4.5 4.5 0 1113.5 16h-8z"></path>
                </svg>
            </div>
            <div class="sidebar-text">
                <h2 class="text-base font-bold text-white">ClimaChat</h2>
                <p class="text-xs text-gray-300">Admin Panel</p>
            </div>
        </div>
        <button id="sidebar-toggle" class="text-gray-400 hover:text-white transition-colors">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7"></path>
            </svg>
        </button>
    </div>

    <!-- Navigation -->
    <nav class="flex-1 px-4 pb-4">
        <div class="space-y-1">
            <!-- Dashboard -->
            <a href="{% url 'admin_dashboard' %}" class="{% if request.resolver_match.url_name == 'admin_dashboard' %}bg-blue-600 text-white border-l-4 border-blue-400{% else %}text-gray-300 hover:bg-slate-700 hover:text-white{% endif %} flex items-center px-4 py-3 rounded-lg transition-all duration-200 relative">
                <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5a2 2 0 012-2h4a2 2 0 012 2v2H8V5z"></path>
                </svg>
                <span class="font-medium sidebar-text">Dashboard</span>
                {% if request.resolver_match.url_name == 'admin_dashboard' %}
                <div class="absolute right-2 w-2 h-2 bg-blue-400 rounded-full"></div>
                {% endif %}
            </a>

            <!-- Users -->
            <a href="{% url 'admin_users' %}" class="{% if request.resolver_match.url_name == 'admin_users' %}bg-blue-600 text-white border-l-4 border-blue-400{% else %}text-gray-300 hover:bg-slate-700 hover:text-white{% endif %} flex items-center px-4 py-3 rounded-lg transition-all duration-200 relative">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                </svg>
                <span class="font-medium sidebar-text">Users</span>
                {% if request.resolver_match.url_name == 'admin_users' %}
                <div class="absolute right-2 w-2 h-2 bg-blue-400 rounded-full"></div>
                {% endif %}
            </a>

            <!-- Messages -->
            <a href="{% url 'admin_chat' %}" class="{% if request.resolver_match.url_name == 'admin_chat' %}bg-blue-600 text-white border-l-4 border-blue-400{% else %}text-gray-300 hover:bg-slate-700 hover:text-white{% endif %} flex items-center px-4 py-3 rounded-lg transition-all duration-200 relative">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                </svg>
                <span class="font-medium sidebar-text">Weather Bot</span>
                {% if request.resolver_match.url_name == 'admin_chat' %}
                <div class="absolute right-2 w-2 h-2 bg-blue-400 rounded-full"></div>
                {% endif %}
            </a>

            <!-- Alerts -->
            <a href="{% url 'admin_weather_alerts' %}" class="{% if request.resolver_match.url_name == 'admin_weather_alerts' %}bg-blue-600 text-white border-l-4 border-blue-400{% else %}text-gray-300 hover:bg-slate-700 hover:text-white{% endif %} flex items-center px-4 py-3 rounded-lg transition-all duration-200 relative">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.314 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                </svg>
                <span class="font-medium sidebar-text">Weather Alerts</span>
                {% if request.resolver_match.url_name == 'admin_weather_alerts' %}
                <div class="absolute right-2 w-2 h-2 bg-blue-400 rounded-full"></div>
                {% endif %}
            </a>

            <!-- Weather Map -->
            <a href="{% url 'admin_weather_map' %}" class="{% if request.resolver_match.url_name == 'admin_weather_map' %}bg-blue-600 text-white border-l-4 border-blue-400{% else %}text-gray-300 hover:bg-slate-700 hover:text-white{% endif %} flex items-center px-4 py-3 rounded-lg transition-all duration-200 relative">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path>
                </svg>
                <span class="font-medium sidebar-text">Weather Map</span>
                {% if request.resolver_match.url_name == 'admin_weather_map' %}
                <div class="absolute right-2 w-2 h-2 bg-blue-400 rounded-full"></div>
                {% endif %}
            </a>

            <!-- Logs -->
            <a href="{% url 'admin_logs' %}" class="{% if request.resolver_match.url_name == 'admin_logs' %}bg-blue-600 text-white border-l-4 border-blue-400{% else %}text-gray-300 hover:bg-slate-700 hover:text-white{% endif %} flex items-center px-4 py-3 rounded-lg transition-all duration-200 relative">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                <span class="font-medium sidebar-text">Activity Logs</span>
                {% if request.resolver_match.url_name == 'admin_logs' %}
                <div class="absolute right-2 w-2 h-2 bg-blue-400 rounded-full"></div>
                {% endif %}
            </a>

            <!-- Settings -->
          
        </div>

        <!-- Bottom Section -->
        <div class="mt-auto pt-6 space-y-1">
            <!-- Profile -->
            <a href="{% url 'admin_profile' %}" class="{% if request.resolver_match.url_name == 'admin_profile' %}bg-blue-600 text-white border-l-4 border-blue-400{% else %}text-gray-300 hover:bg-slate-700 hover:text-white{% endif %} flex items-center px-4 py-3 rounded-lg transition-all duration-200 relative">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                </svg>
                <span class="font-medium sidebar-text">Profile</span>
                {% if request.resolver_match.url_name == 'admin_profile' %}
                <div class="absolute right-2 w-2 h-2 bg-blue-400 rounded-full"></div>
                {% endif %}
            </a>

            <!-- Logout -->
            <a href="{% url 'user_logout' %}" class="flex items-center px-4 py-3 text-gray-300 hover:bg-slate-700 hover:text-white rounded-lg transition-all duration-200 relative">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                </svg>
                <span class="font-medium sidebar-text">Logout</span>
            </a>
        </div>
    </nav>
</div>

<style>
/* Sidebar transitions */
#admin-sidebar {
    transition: width 0.3s ease;
}

#admin-sidebar.collapsed {
    width: 70px !important;
}

#admin-sidebar.collapsed .sidebar-text {
    display: none;
}

#admin-sidebar.collapsed #sidebar-toggle svg {
    transform: rotate(180deg);
}

/* Center icons when collapsed */
#admin-sidebar.collapsed nav a {
    justify-content: center;
    padding-left: 0;
    padding-right: 0;
}

#admin-sidebar.collapsed nav a svg {
    margin-right: 0;
}

/* Hide active indicator dot when collapsed */
#admin-sidebar.collapsed .absolute.right-2 {
    display: none;
}

/* Hide border when collapsed */
#admin-sidebar.collapsed nav a.border-l-4 {
    border-left-width: 0;
}

/* Center logo icon when collapsed */
#admin-sidebar.collapsed .p-4 {
    justify-content: center;
}
</style>

<script>
(function() {
    const sidebar = document.getElementById('admin-sidebar');
    const toggleBtn = document.getElementById('sidebar-toggle');
    const mainContent = document.getElementById('main-content');

    if (!sidebar || !toggleBtn) return;

    // Load saved state
    const isCollapsed = localStorage.getItem('sidebarCollapsed') === 'true';
    if (isCollapsed) {
        sidebar.classList.add('collapsed');
    }

    // Toggle sidebar on button click
    toggleBtn.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();

        sidebar.classList.toggle('collapsed');

        const nowCollapsed = sidebar.classList.contains('collapsed');
        localStorage.setItem('sidebarCollapsed', nowCollapsed.toString());
    });
})();
</script>